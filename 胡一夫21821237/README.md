主题：神经网络在图像风格化绘制中的应用  
论文：https://arxiv.org/pdf/1508.06576v2.pdf  
本文构建了一个基于深度卷积神经网络的智能系统，绘制出具有艺术价值的图像。对于任意图片，该系统将使用神经元表征对其风格和内容进行分离。通过将不同艺术作品的风格特征融合到普通照片的内容特征，该方法可以对普通照片进行各式各样的艺术化的生成。 

使用VGG19网络。本来是用于物体识别的。但是认为其中编码了高级的“content”信息。而之前有研究显示在神经网络上定义的Gram矩阵可以用于提取图像的texture。把两者结合，即可实现内容和风格的融合。在VGG19的结构中选择content layer和style layer（论文分别使用conv4_2和conv1_1 -> conv5_1的集合）。计算内容图的content激活值；计算风格图的style激活值。使用这些激活值作为特征。从白噪声开始，优化损失函数。最后得到结果。 

输入：风格图、内容图、初始图。 
风格图大小任意。内容图和初始图大小需要一致。 
对于风格图，计算它在conv1_1, conv2_1, ..., conv5_1的Gram矩阵。这个矩阵即为“style”特征。 
以conv5_1为例。假设风格图的大小是h\*w\*3的。那么当它到达第五组卷积层时，大小为(h/16)\*(w/16)\*512，记为s。该组卷积层拥有512个过滤器，因此风格图在本层的原始激活值是一个s\*512的矩阵。这个矩阵的转置乘以自己，变成对角阵。这个对角阵是512*512的。它就是Gram矩阵，即风格特征。  
对于内容图，计算方法类似，只不过在conv4_2。它的激活值是(h/8)\*(w/8)\*512的矩阵。这就是内容特征。  
对于初始图，我们也可以计算出它的对应的内容特征和风格特征。 

定义了上述损失函数之后，即可利用反向传播算法，逐步修改初始图的像素值。经过数次迭代可得结果。

![](./neuralStyle.png)

![](./vgg16.png)

反向传播中，最重要的应用链式法则进行求导。对于内容特征和风格特征，它们的导数分别是：
